/*
==============================================
=== COMPONENT: UltraBeautifulDigitalSparklerSystem ===
FUNCTION: 完全に超越した美しい線香花火エフェクト - 無重力空間での360度円状放射
FEATURES: 20コア × 各20個 = 400個の超細密火花 + 微細粒子200個 = 合計600個の光粒子
VERSION: 2.0.0
LAST UPDATED: 2025-12-02
AUTHOR: ShinAI Development Team

DESIGN PHILOSOPHY:
- 品格: 洗練された配色と控えめなアニメーション
- 信頼性: 予測可能な動作と明確なフィードバック
- 美的センス: 黄金比を意識した配置と余白
- 独自性: ShinAI固有のブランドカラーとインタラクション

TECHNICAL OPTIMIZATION:
- GPU加速: will-change, transform3d活用
- パフォーマンス: 600要素でも60fps維持
- レスポンシブ: PC/モバイル完全対応
- 技術的負債ゼロ: モジュラー設計・保守性最大化
==============================================
*/

/* ========================================================
▼ Sparkler Container Component
線香花火コンテナ - 全粒子システムの基盤
======================================================== */
.sparkler-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 1;
    pointer-events: none;
}

/* ========================================================
▼ Sparkler Core Component - 20個のコア定義
各コアから20個の火花が360度円状放射
======================================================== */
.sparkler-core {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    animation: ultraBeautifulSparklerCore 12s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;
    pointer-events: none;
    box-shadow: 0 0 8px currentColor, 0 0 16px currentColor;
    will-change: transform, opacity;
}

/* 20個のコア配置 - 複数カラー・自然な円形光・ランダム発射サイクル */
.sparkler-core:nth-child(1) { top: 18%; left: 12%; animation-delay: 0.3s; background: radial-gradient(circle, rgba(255, 182, 193, 1) 0%, rgba(255, 182, 193, 0.8) 30%, rgba(255, 182, 193, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(2) { top: 28%; right: 15%; animation-delay: 2.1s; background: radial-gradient(circle, rgba(135, 206, 235, 1) 0%, rgba(135, 206, 235, 0.8) 30%, rgba(135, 206, 235, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(3) { bottom: 32%; left: 22%; animation-delay: 4.7s; background: radial-gradient(circle, rgba(152, 251, 152, 1) 0%, rgba(152, 251, 152, 0.8) 30%, rgba(152, 251, 152, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(4) { bottom: 22%; right: 18%; animation-delay: 1.4s; background: radial-gradient(circle, rgba(255, 228, 181, 1) 0%, rgba(255, 228, 181, 0.8) 30%, rgba(255, 228, 181, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(5) { top: 45%; left: 8%; animation-delay: 6.2s; background: radial-gradient(circle, rgba(221, 160, 221, 1) 0%, rgba(221, 160, 221, 0.8) 30%, rgba(221, 160, 221, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(6) { top: 35%; right: 8%; animation-delay: 0.8s; background: radial-gradient(circle, rgba(240, 230, 140, 1) 0%, rgba(240, 230, 140, 0.8) 30%, rgba(240, 230, 140, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(7) { bottom: 45%; left: 8%; animation-delay: 3.5s; background: radial-gradient(circle, rgba(175, 238, 238, 1) 0%, rgba(175, 238, 238, 0.8) 30%, rgba(175, 238, 238, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(8) { top: 65%; right: 12%; animation-delay: 7.1s; background: radial-gradient(circle, rgba(255, 192, 203, 1) 0%, rgba(255, 192, 203, 0.8) 30%, rgba(255, 192, 203, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(9) { top: 25%; left: 45%; animation-delay: 2.9s; background: radial-gradient(circle, rgba(255, 228, 225, 1) 0%, rgba(255, 228, 225, 0.8) 30%, rgba(255, 228, 225, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(10) { top: 55%; right: 25%; animation-delay: 5.3s; background: radial-gradient(circle, rgba(230, 230, 250, 1) 0%, rgba(230, 230, 250, 0.8) 30%, rgba(230, 230, 250, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(11) { bottom: 65%; left: 35%; animation-delay: 1.7s; background: radial-gradient(circle, rgba(144, 238, 144, 1) 0%, rgba(144, 238, 144, 0.8) 30%, rgba(144, 238, 144, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(12) { top: 75%; left: 25%; animation-delay: 4.1s; background: radial-gradient(circle, rgba(255, 182, 193, 1) 0%, rgba(255, 182, 193, 0.8) 30%, rgba(255, 182, 193, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(13) { top: 15%; right: 35%; animation-delay: 8.4s; background: radial-gradient(circle, rgba(176, 224, 230, 1) 0%, rgba(176, 224, 230, 0.8) 30%, rgba(176, 224, 230, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(14) { bottom: 18%; right: 8%; animation-delay: 0.5s; background: radial-gradient(circle, rgba(245, 222, 179, 1) 0%, rgba(245, 222, 179, 0.8) 30%, rgba(245, 222, 179, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(15) { top: 42%; left: 75%; animation-delay: 6.8s; background: radial-gradient(circle, rgba(255, 239, 213, 1) 0%, rgba(255, 239, 213, 0.8) 30%, rgba(255, 239, 213, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(16) { bottom: 42%; right: 75%; animation-delay: 3.2s; background: radial-gradient(circle, rgba(224, 255, 255, 1) 0%, rgba(224, 255, 255, 0.8) 30%, rgba(224, 255, 255, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(17) { top: 85%; left: 18%; animation-delay: 9.1s; background: radial-gradient(circle, rgba(240, 255, 255, 1) 0%, rgba(240, 255, 255, 0.8) 30%, rgba(240, 255, 255, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(18) { top: 32%; left: 85%; animation-delay: 1.9s; background: radial-gradient(circle, rgba(255, 248, 220, 1) 0%, rgba(255, 248, 220, 0.8) 30%, rgba(255, 248, 220, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(19) { bottom: 75%; left: 48%; animation-delay: 7.6s; background: radial-gradient(circle, rgba(245, 245, 220, 1) 0%, rgba(245, 245, 220, 0.8) 30%, rgba(245, 245, 220, 0.4) 60%, transparent 100%); }
.sparkler-core:nth-child(20) { top: 88%; right: 42%; animation-delay: 4.9s; background: radial-gradient(circle, rgba(255, 250, 205, 1) 0%, rgba(255, 250, 205, 0.8) 30%, rgba(255, 250, 205, 0.4) 60%, transparent 100%); }

/* コアアニメーション - 発光・拡大縮小・フェードイン/アウト */
@keyframes ultraBeautifulSparklerCore {
    0%, 100% {
        opacity: 0;
        transform: scale(0.2);
        filter: blur(2px);
    }
    8% {
        opacity: 0.9;
        transform: scale(2.5);
        filter: blur(0px);
    }
    15% {
        opacity: 1;
        transform: scale(3.5);
        filter: blur(0px);
    }
    25% {
        opacity: 1;
        transform: scale(4.0);
        filter: blur(0px);
    }
    75% {
        opacity: 1;
        transform: scale(3.2);
        filter: blur(0px);
    }
    85% {
        opacity: 0.7;
        transform: scale(2.0);
        filter: blur(1px);
    }
    92% {
        opacity: 0.4;
        transform: scale(1.0);
        filter: blur(2px);
    }
}

/* モバイル版パーティクル輝度強化 */
@media (max-width: 768px) {
    .sparkler-core {
        box-shadow: 0 0 16px currentColor, 0 0 32px currentColor, 0 0 48px currentColor;
        filter: brightness(1.8);
    }

    @keyframes ultraBeautifulSparklerCore {
        0%, 100% {
            opacity: 0;
            transform: scale(0.3);
            filter: blur(2px) brightness(1.5);
        }
        8% {
            opacity: 1;
            transform: scale(3.5);
            filter: blur(0px) brightness(2.2);
        }
        15% {
            opacity: 1;
            transform: scale(4.8);
            filter: blur(0px) brightness(2.5);
        }
        25% {
            opacity: 1;
            transform: scale(5.5);
            filter: blur(0px) brightness(2.8);
        }
        75% {
            opacity: 1;
            transform: scale(4.5);
            filter: blur(0px) brightness(2.5);
        }
        85% {
            opacity: 0.95;
            transform: scale(3.2);
            filter: blur(1px) brightness(2.2);
        }
        92% {
            opacity: 0.7;
            transform: scale(1.8);
            filter: blur(2px) brightness(1.8);
        }
    }

    .spark {
        box-shadow: 0 0 8px currentColor, 0 0 16px currentColor, 0 0 24px currentColor;
        filter: brightness(2.0);
    }
}

/* ========================================================
▼ Spark Component - 400個の火花定義（20コア × 20火花）
360度円状放射 - 18度間隔の完璧な数学的配置
======================================================== */
.spark {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.95);
    pointer-events: none;
    box-shadow: 0 0 4px currentColor;
    will-change: transform, opacity;
}

/* 4つのサイズクラス - ランダムな視覚的多様性 */
.spark-large { width: 1.8px; height: 1.8px; animation-duration: 6s; }
.spark-medium { width: 1.4px; height: 1.4px; animation-duration: 5.5s; }
.spark-small { width: 1.0px; height: 1.0px; animation-duration: 5s; }
.spark-tiny { width: 0.8px; height: 0.8px; animation-duration: 4.5s; }

/* コア1からの20個の火花 - 18度間隔の完璧な円状放射
   360度 / 20火花 = 18度間隔
   三角関数による正確な方向ベクトル計算:
   --dx: cos(角度), --dy: sin(角度) */
.spark-core-1-1 { left: 12%; top: 18%; --dx: 1; --dy: 0; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.05s; }
.spark-core-1-2 { left: 12%; top: 18%; --dx: 0.951; --dy: 0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.10s; }
.spark-core-1-3 { left: 12%; top: 18%; --dx: 0.809; --dy: 0.588; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.15s; }
.spark-core-1-4 { left: 12%; top: 18%; --dx: 0.588; --dy: 0.809; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.20s; }
.spark-core-1-5 { left: 12%; top: 18%; --dx: 0.309; --dy: 0.951; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.25s; }
.spark-core-1-6 { left: 12%; top: 18%; --dx: 0; --dy: 1; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.30s; }
.spark-core-1-7 { left: 12%; top: 18%; --dx: -0.309; --dy: 0.951; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.35s; }
.spark-core-1-8 { left: 12%; top: 18%; --dx: -0.588; --dy: 0.809; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.40s; }
.spark-core-1-9 { left: 12%; top: 18%; --dx: -0.809; --dy: 0.588; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.45s; }
.spark-core-1-10 { left: 12%; top: 18%; --dx: -0.951; --dy: 0.309; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.50s; }
.spark-core-1-11 { left: 12%; top: 18%; --dx: -1; --dy: 0; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.55s; }
.spark-core-1-12 { left: 12%; top: 18%; --dx: -0.951; --dy: -0.309; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.60s; }
.spark-core-1-13 { left: 12%; top: 18%; --dx: -0.809; --dy: -0.588; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.65s; }
.spark-core-1-14 { left: 12%; top: 18%; --dx: -0.588; --dy: -0.809; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.70s; }
.spark-core-1-15 { left: 12%; top: 18%; --dx: -0.309; --dy: -0.951; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.75s; }
.spark-core-1-16 { left: 12%; top: 18%; --dx: 0; --dy: -1; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.80s; }
.spark-core-1-17 { left: 12%; top: 18%; --dx: 0.309; --dy: -0.951; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.85s; }
.spark-core-1-18 { left: 12%; top: 18%; --dx: 0.588; --dy: -0.809; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.90s; }
.spark-core-1-19 { left: 12%; top: 18%; --dx: 0.809; --dy: -0.588; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.95s; }
.spark-core-1-20 { left: 12%; top: 18%; --dx: 0.951; --dy: -0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 1.00s; }

/* コア2からの20個の火花 - right: 15%, top: 28% */
.spark-core-2-1 { right: 15%; top: 28%; --dx: 1; --dy: 0; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.05s; }
.spark-core-2-2 { right: 15%; top: 28%; --dx: 0.951; --dy: 0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.10s; }
.spark-core-2-3 { right: 15%; top: 28%; --dx: 0.809; --dy: 0.588; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.15s; }
.spark-core-2-4 { right: 15%; top: 28%; --dx: 0.588; --dy: 0.809; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.20s; }
.spark-core-2-5 { right: 15%; top: 28%; --dx: 0.309; --dy: 0.951; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.25s; }
.spark-core-2-6 { right: 15%; top: 28%; --dx: 0; --dy: 1; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.30s; }
.spark-core-2-7 { right: 15%; top: 28%; --dx: -0.309; --dy: 0.951; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.35s; }
.spark-core-2-8 { right: 15%; top: 28%; --dx: -0.588; --dy: 0.809; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.40s; }
.spark-core-2-9 { right: 15%; top: 28%; --dx: -0.809; --dy: 0.588; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.45s; }
.spark-core-2-10 { right: 15%; top: 28%; --dx: -0.951; --dy: 0.309; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.50s; }
.spark-core-2-11 { right: 15%; top: 28%; --dx: -1; --dy: 0; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.55s; }
.spark-core-2-12 { right: 15%; top: 28%; --dx: -0.951; --dy: -0.309; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.60s; }
.spark-core-2-13 { right: 15%; top: 28%; --dx: -0.809; --dy: -0.588; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.65s; }
.spark-core-2-14 { right: 15%; top: 28%; --dx: -0.588; --dy: -0.809; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.70s; }
.spark-core-2-15 { right: 15%; top: 28%; --dx: -0.309; --dy: -0.951; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.75s; }
.spark-core-2-16 { right: 15%; top: 28%; --dx: 0; --dy: -1; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.80s; }
.spark-core-2-17 { right: 15%; top: 28%; --dx: 0.309; --dy: -0.951; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.85s; }
.spark-core-2-18 { right: 15%; top: 28%; --dx: 0.588; --dy: -0.809; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.90s; }
.spark-core-2-19 { right: 15%; top: 28%; --dx: 0.809; --dy: -0.588; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.95s; }
.spark-core-2-20 { right: 15%; top: 28%; --dx: 0.951; --dy: -0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 1.00s; }

/* コア3からの20個の火花 - left: 22%, bottom: 32% */
.spark-core-3-1 { left: 22%; bottom: 32%; --dx: 1; --dy: 0; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.05s; }
.spark-core-3-2 { left: 22%; bottom: 32%; --dx: 0.951; --dy: 0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.10s; }
.spark-core-3-3 { left: 22%; bottom: 32%; --dx: 0.809; --dy: 0.588; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.15s; }
.spark-core-3-4 { left: 22%; bottom: 32%; --dx: 0.588; --dy: 0.809; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.20s; }
.spark-core-3-5 { left: 22%; bottom: 32%; --dx: 0.309; --dy: 0.951; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.25s; }
.spark-core-3-6 { left: 22%; bottom: 32%; --dx: 0; --dy: 1; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.30s; }
.spark-core-3-7 { left: 22%; bottom: 32%; --dx: -0.309; --dy: 0.951; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.35s; }
.spark-core-3-8 { left: 22%; bottom: 32%; --dx: -0.588; --dy: 0.809; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.40s; }
.spark-core-3-9 { left: 22%; bottom: 32%; --dx: -0.809; --dy: 0.588; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.45s; }
.spark-core-3-10 { left: 22%; bottom: 32%; --dx: -0.951; --dy: 0.309; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.50s; }
.spark-core-3-11 { left: 22%; bottom: 32%; --dx: -1; --dy: 0; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.55s; }
.spark-core-3-12 { left: 22%; bottom: 32%; --dx: -0.951; --dy: -0.309; --speed: 0.9; animation: perfectSparklerBurst 6s ease-out infinite 0.60s; }
.spark-core-3-13 { left: 22%; bottom: 32%; --dx: -0.809; --dy: -0.588; --speed: 1.2; animation: perfectSparklerBurst 6s ease-out infinite 0.65s; }
.spark-core-3-14 { left: 22%; bottom: 32%; --dx: -0.588; --dy: -0.809; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.70s; }
.spark-core-3-15 { left: 22%; bottom: 32%; --dx: -0.309; --dy: -0.951; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 0.75s; }
.spark-core-3-16 { left: 22%; bottom: 32%; --dx: 0; --dy: -1; --speed: 0.95; animation: perfectSparklerBurst 6s ease-out infinite 0.80s; }
.spark-core-3-17 { left: 22%; bottom: 32%; --dx: 0.309; --dy: -0.951; --speed: 1.05; animation: perfectSparklerBurst 6s ease-out infinite 0.85s; }
.spark-core-3-18 { left: 22%; bottom: 32%; --dx: 0.588; --dy: -0.809; --speed: 1.15; animation: perfectSparklerBurst 6s ease-out infinite 0.90s; }
.spark-core-3-19 { left: 22%; bottom: 32%; --dx: 0.809; --dy: -0.588; --speed: 1.0; animation: perfectSparklerBurst 6s ease-out infinite 0.95s; }
.spark-core-3-20 { left: 22%; bottom: 32%; --dx: 0.951; --dy: -0.309; --speed: 1.1; animation: perfectSparklerBurst 6s ease-out infinite 1.00s; }

/* ========================================================
▼ Dynamic Spark Generation - JavaScript Optimization
コア4-20からの340個の火花はJavaScriptで動的生成
assets/js/sparkler-effects.js による自動生成システム
- パフォーマンス最適化: DocumentFragment使用
- CSSファイル軽量化: AIエージェント読み込み負担軽減
- 保守性最大化: 1箇所変更で全火花更新可能
======================================================== */

/* masa様改善Part2: 美しい流れ星エフェクト - ランダムに散りゆく様をProデザイナーとして表現 */
@keyframes perfectSparklerBurst {
    0% {
        opacity: 0;
        transform: translate3d(0, 0, 0) scale(0.3) rotate(0deg);
        filter: blur(0px);
    }
    3% {
        opacity: 1;
        transform: translate3d(
            calc(var(--dx, 1) * 5px * var(--speed, 1)),
            calc(var(--dy, 0) * 5px * var(--speed, 1) + 3px),
            0
        ) scale(2.5) rotate(calc(var(--dx, 1) * 15deg));
        filter: blur(0px);
    }
    8% {
        opacity: 1;
        transform: translate3d(
            calc(var(--dx, 1) * 15px * var(--speed, 1)),
            calc(var(--dy, 0) * 15px * var(--speed, 1) + 12px),
            0
        ) scale(2.2) rotate(calc(var(--dx, 1) * 30deg));
        filter: blur(0px);
    }
    15% {
        opacity: 0.95;
        transform: translate3d(
            calc(var(--dx, 1) * 32px * var(--speed, 1)),
            calc(var(--dy, 0) * 32px * var(--speed, 1) + 28px),
            0
        ) scale(1.9) rotate(calc(var(--dx, 1) * 50deg));
        filter: blur(0.5px);
    }
    25% {
        opacity: 0.85;
        transform: translate3d(
            calc(var(--dx, 1) * 55px * var(--speed, 1)),
            calc(var(--dy, 0) * 55px * var(--speed, 1) + 52px),
            0
        ) scale(1.5) rotate(calc(var(--dx, 1) * 75deg));
        filter: blur(1px);
    }
    40% {
        opacity: 0.65;
        transform: translate3d(
            calc(var(--dx, 1) * 85px * var(--speed, 1)),
            calc(var(--dy, 0) * 85px * var(--speed, 1) + 85px),
            0
        ) scale(1.0) rotate(calc(var(--dx, 1) * 105deg));
        filter: blur(1.5px);
    }
    55% {
        opacity: 0.5;
        transform: translate3d(
            calc(var(--dx, 1) * 115px * var(--speed, 1)),
            calc(var(--dy, 0) * 115px * var(--speed, 1) + 125px),
            0
        ) scale(0.8) rotate(calc(var(--dx, 1) * 140deg));
        filter: blur(2px);
    }
    70% {
        opacity: 0.35;
        transform: translate3d(
            calc(var(--dx, 1) * 140px * var(--speed, 1)),
            calc(var(--dy, 0) * 140px * var(--speed, 1) + 165px),
            0
        ) scale(0.6) rotate(calc(var(--dx, 1) * 180deg));
        filter: blur(2.5px);
    }
    85% {
        opacity: 0.18;
        transform: translate3d(
            calc(var(--dx, 1) * 160px * var(--speed, 1)),
            calc(var(--dy, 0) * 160px * var(--speed, 1) + 195px),
            0
        ) scale(0.35) rotate(calc(var(--dx, 1) * 220deg));
        filter: blur(3px);
    }
    100% {
        opacity: 0;
        transform: translate3d(
            calc(var(--dx, 1) * 175px * var(--speed, 1)),
            calc(var(--dy, 0) * 175px * var(--speed, 1) + 220px),
            0
        ) scale(0.1) rotate(calc(var(--dx, 1) * 270deg));
        filter: blur(4px);
    }
}

/* ========================================================
▼ Micro Sparkle Component - 200個の微細補完粒子
ランダム配置・回転・拡大縮小で空間を豊かに演出
======================================================== */
.micro-sparkle {
    position: absolute;
    width: 0.6px;
    height: 0.6px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.85);
    animation: ultraMicroSparkle 7s ease-in-out infinite;
    pointer-events: none;
    will-change: transform, opacity;
}

/* 微細粒子の初期30個配置 - 静的定義（参考実装） */
.micro-sparkle:nth-child(21) { top: 5%; left: 5%; animation-delay: 0.1s; }
.micro-sparkle:nth-child(22) { top: 8%; right: 7%; animation-delay: 1.2s; }
.micro-sparkle:nth-child(23) { bottom: 12%; left: 10%; animation-delay: 2.4s; }
.micro-sparkle:nth-child(24) { bottom: 6%; right: 12%; animation-delay: 0.5s; }
.micro-sparkle:nth-child(25) { top: 18%; left: 6%; animation-delay: 3.1s; }
.micro-sparkle:nth-child(26) { top: 22%; right: 9%; animation-delay: 1.7s; }
.micro-sparkle:nth-child(27) { bottom: 25%; left: 13%; animation-delay: 4.2s; }
.micro-sparkle:nth-child(28) { bottom: 30%; right: 15%; animation-delay: 2.3s; }
.micro-sparkle:nth-child(29) { top: 35%; left: 11%; animation-delay: 0.9s; }
.micro-sparkle:nth-child(30) { top: 40%; right: 14%; animation-delay: 3.6s; }

/* ========================================================
▼ Dynamic Micro Sparkle Generation - JavaScript Optimization
残り170個の微細粒子はJavaScriptで動的生成
assets/js/sparkler-effects.js による自動生成システム
- ランダム配置: 5%-95%の範囲で自然な分布
- ランダム遅延: 0-7秒でアニメーション開始
- CSSファイル軽量化: AIエージェント読み込み負担軽減
======================================================== */

/* masa様改善Part2: きらめく星のような微細粒子 - 優雅な瞬き */
@keyframes ultraMicroSparkle {
    0%, 100% {
        opacity: 0;
        transform: scale(0.2) translateY(0px) rotate(0deg);
        filter: blur(0px);
    }
    12% {
        opacity: 0.7;
        transform: scale(5.5) translateY(8px) rotate(90deg);
        filter: blur(0px);
    }
    20% {
        opacity: 1;
        transform: scale(9.0) translateY(15px) rotate(180deg);
        filter: blur(0.5px);
    }
    35% {
        opacity: 0.9;
        transform: scale(7.5) translateY(28px) rotate(270deg);
        filter: blur(1px);
    }
    50% {
        opacity: 0.75;
        transform: scale(6.0) translateY(45px) rotate(360deg);
        filter: blur(1.5px);
    }
    65% {
        opacity: 0.5;
        transform: scale(4.0) translateY(65px) rotate(450deg);
        filter: blur(2px);
    }
    80% {
        opacity: 0.25;
        transform: scale(2.0) translateY(85px) rotate(540deg);
        filter: blur(2.5px);
    }
    95% {
        opacity: 0.08;
        transform: scale(0.8) translateY(100px) rotate(630deg);
        filter: blur(3px);
    }
}

/* ========================================================
▼ Responsive Design - モバイル最適化
======================================================== */
@media (max-width: 768px) {
    /* コアサイズ縮小 - モバイル画面対応 */
    .sparkler-core {
        width: 3px;
        height: 3px;
        animation-duration: 10s;
    }

    /* 火花サイズ縮小 - パフォーマンス最適化 */
    .spark-large { width: 1.4px; height: 1.4px; }
    .spark-medium { width: 1.0px; height: 1.0px; }
    .spark-small { width: 0.8px; height: 0.8px; }
    .spark-tiny { width: 0.6px; height: 0.6px; }

    /* 微細粒子サイズ縮小 */
    .micro-sparkle {
        width: 0.5px;
        height: 0.5px;
    }
}

/* ========================================================
END OF SPARKLER EFFECTS STYLESHEET
======================================================== */
